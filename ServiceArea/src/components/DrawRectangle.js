function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=t((function(e,t){function n(e,t,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function r(e,t,r){return void 0===r&&(r={}),n({type:"Point",coordinates:e},t,r)}function i(e,t,r){void 0===r&&(r={});for(var i=0,o=e;i<o.length;i++){var a=o[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<a[a.length-1].length;l++)if(a[a.length-1][l]!==a[0][l])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:e},t,r)}function o(e,t,r){if(void 0===r&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:e},t,r)}function a(e,t){void 0===t&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function l(e,t,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:e},t,r)}function s(e,t,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:e},t,r)}function c(e,t,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:e},t,r)}function u(e,n){void 0===n&&(n="kilometers");var r=t.factors[n];if(!r)throw new Error(n+" units is invalid");return e*r}function d(e,n){void 0===n&&(n="kilometers");var r=t.factors[n];if(!r)throw new Error(n+" units is invalid");return e/r}function g(e){return 180*(e%(2*Math.PI))/Math.PI}function f(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=n,t.geometry=function(e,t,n){switch(e){case"Point":return r(t).geometry;case"LineString":return o(t).geometry;case"Polygon":return i(t).geometry;case"MultiPoint":return s(t).geometry;case"MultiLineString":return l(t).geometry;case"MultiPolygon":return c(t).geometry;default:throw new Error(e+" is invalid")}},t.point=r,t.points=function(e,t,n){return void 0===n&&(n={}),a(e.map((function(e){return r(e,t)})),n)},t.polygon=i,t.polygons=function(e,t,n){return void 0===n&&(n={}),a(e.map((function(e){return i(e,t)})),n)},t.lineString=o,t.lineStrings=function(e,t,n){return void 0===n&&(n={}),a(e.map((function(e){return o(e,t)})),n)},t.featureCollection=a,t.multiLineString=l,t.multiPoint=s,t.multiPolygon=c,t.geometryCollection=function(e,t,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:e},t,r)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,t||0);return Math.round(e*n)/n},t.radiansToLength=u,t.lengthToRadians=d,t.lengthToDegrees=function(e,t){return g(d(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=g,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,n){if(void 0===t&&(t="kilometers"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("length must be a positive number");return u(d(e,t),n)},t.convertArea=function(e,n,r){if(void 0===n&&(n="meters"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("area must be a positive number");var i=t.areaFactors[n];if(!i)throw new Error("invalid original units");var o=t.areaFactors[r];if(!o)throw new Error("invalid final units");return e/i*o},t.isNumber=f,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!f(e))throw new Error("bbox must only contain numbers")}))},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},t.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},t.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},t.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},t.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},t.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},t.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},t.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}}));e(n);n.earthRadius,n.factors,n.unitsFactors,n.areaFactors,n.feature,n.geometry,n.point,n.points,n.polygon,n.polygons,n.lineString,n.lineStrings,n.featureCollection,n.multiLineString,n.multiPoint,n.multiPolygon,n.geometryCollection,n.round,n.radiansToLength,n.lengthToRadians,n.lengthToDegrees,n.bearingToAzimuth,n.radiansToDegrees,n.degreesToRadians,n.convertLength,n.convertArea,n.isNumber,n.isObject,n.validateBBox,n.validateId,n.radians2degrees,n.degrees2radians,n.distanceToDegrees,n.distanceToRadians,n.radiansToDistance,n.bearingToAngle,n.convertDistance;var r=t((function(e,t){function r(e,t,n){if(null!==e)for(var i,o,a,l,s,c,u,d,g=0,f=0,p=e.type,h="FeatureCollection"===p,y="Feature"===p,m=h?e.features.length:1,v=0;v<m;v++){s=(d=!!(u=h?e.features[v].geometry:y?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var b=0;b<s;b++){var E=0,w=0;if(null!==(l=d?u.geometries[b]:u)){c=l.coordinates;var P=l.type;switch(g=!n||"Polygon"!==P&&"MultiPolygon"!==P?0:1,P){case null:break;case"Point":if(!1===t(c,f,v,E,w))return!1;f++,E++;break;case"LineString":case"MultiPoint":for(i=0;i<c.length;i++){if(!1===t(c[i],f,v,E,w))return!1;f++,"MultiPoint"===P&&E++}"LineString"===P&&E++;break;case"Polygon":case"MultiLineString":for(i=0;i<c.length;i++){for(o=0;o<c[i].length-g;o++){if(!1===t(c[i][o],f,v,E,w))return!1;f++}"MultiLineString"===P&&E++,"Polygon"===P&&w++}"Polygon"===P&&E++;break;case"MultiPolygon":for(i=0;i<c.length;i++){for(w=0,o=0;o<c[i].length;o++){for(a=0;a<c[i][o].length-g;a++){if(!1===t(c[i][o][a],f,v,E,w))return!1;f++}w++}E++}break;case"GeometryCollection":for(i=0;i<l.geometries.length;i++)if(!1===r(l.geometries[i],t,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function i(e,t){var n;switch(e.type){case"FeatureCollection":for(n=0;n<e.features.length&&!1!==t(e.features[n].properties,n);n++);break;case"Feature":t(e.properties,0)}}function o(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var n=0;n<e.features.length&&!1!==t(e.features[n],n);n++);}function a(e,t){var n,r,i,o,a,l,s,c,u,d,g=0,f="FeatureCollection"===e.type,p="Feature"===e.type,h=f?e.features.length:1;for(n=0;n<h;n++){for(l=f?e.features[n].geometry:p?e.geometry:e,c=f?e.features[n].properties:p?e.properties:{},u=f?e.features[n].bbox:p?e.bbox:void 0,d=f?e.features[n].id:p?e.id:void 0,a=(s=!!l&&"GeometryCollection"===l.type)?l.geometries.length:1,i=0;i<a;i++)if(null!==(o=s?l.geometries[i]:l))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,g,c,u,d))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===t(o.geometries[r],g,c,u,d))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,g,c,u,d))return!1;g++}}function l(e,t){a(e,(function(e,r,i,o,a){var l,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t(n.feature(e,i,{bbox:o,id:a}),r,0)&&void 0}switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon"}for(var c=0;c<e.coordinates.length;c++){var u={type:l,coordinates:e.coordinates[c]};if(!1===t(n.feature(u,i),r,c))return!1}}))}function s(e,t){l(e,(function(e,i,o){var a=0;if(e.geometry){var l=e.geometry.type;if("Point"!==l&&"MultiPoint"!==l){var s,c=0,u=0,d=0;return!1!==r(e,(function(r,l,g,f,p){if(void 0===s||i>c||f>u||p>d)return s=r,c=i,u=f,d=p,void(a=0);var h=n.lineString([s,r],e.properties);if(!1===t(h,i,o,p,a))return!1;a++,s=r}))&&void 0}}}))}function c(e,t){if(!e)throw new Error("geojson is required");l(e,(function(e,r,i){if(null!==e.geometry){var o=e.geometry.type,a=e.geometry.coordinates;switch(o){case"LineString":if(!1===t(e,r,i,0,0))return!1;break;case"Polygon":for(var l=0;l<a.length;l++)if(!1===t(n.lineString(a[l],e.properties),r,i,l))return!1}}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.coordEach=r,t.coordReduce=function(e,t,n,i){var o=n;return r(e,(function(e,r,i,a,l){o=0===r&&void 0===n?e:t(o,e,r,i,a,l)}),i),o},t.propEach=i,t.propReduce=function(e,t,n){var r=n;return i(e,(function(e,i){r=0===i&&void 0===n?e:t(r,e,i)})),r},t.featureEach=o,t.featureReduce=function(e,t,n){var r=n;return o(e,(function(e,i){r=0===i&&void 0===n?e:t(r,e,i)})),r},t.coordAll=function(e){var t=[];return r(e,(function(e){t.push(e)})),t},t.geomEach=a,t.geomReduce=function(e,t,n){var r=n;return a(e,(function(e,i,o,a,l){r=0===i&&void 0===n?e:t(r,e,i,o,a,l)})),r},t.flattenEach=l,t.flattenReduce=function(e,t,n){var r=n;return l(e,(function(e,i,o){r=0===i&&0===o&&void 0===n?e:t(r,e,i,o)})),r},t.segmentEach=s,t.segmentReduce=function(e,t,n){var r=n,i=!1;return s(e,(function(e,o,a,l,s){r=!1===i&&void 0===n?e:t(r,e,o,a,l,s),i=!0})),r},t.lineEach=c,t.lineReduce=function(e,t,n){var r=n;return c(e,(function(e,i,o,a){r=0===i&&void 0===n?e:t(r,e,i,o,a)})),r},t.findSegment=function(e,t){if(t=t||{},!n.isObject(t))throw new Error("options is invalid");var r,i=t.featureIndex||0,o=t.multiFeatureIndex||0,a=t.geometryIndex||0,l=t.segmentIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":i<0&&(i=e.features.length+i),s=s||e.features[i].properties,r=e.features[i].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var c=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return l<0&&(l=c.length+l-1),n.lineString([c[l],c[l+1]],s,t);case"Polygon":return a<0&&(a=c.length+a),l<0&&(l=c[a].length+l-1),n.lineString([c[a][l],c[a][l+1]],s,t);case"MultiLineString":return o<0&&(o=c.length+o),l<0&&(l=c[o].length+l-1),n.lineString([c[o][l],c[o][l+1]],s,t);case"MultiPolygon":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a),l<0&&(l=c[o][a].length-l-1),n.lineString([c[o][a][l],c[o][a][l+1]],s,t)}throw new Error("geojson is invalid")},t.findPoint=function(e,t){if(t=t||{},!n.isObject(t))throw new Error("options is invalid");var r,i=t.featureIndex||0,o=t.multiFeatureIndex||0,a=t.geometryIndex||0,l=t.coordIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":i<0&&(i=e.features.length+i),s=s||e.features[i].properties,r=e.features[i].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var c=r.coordinates;switch(r.type){case"Point":return n.point(c,s,t);case"MultiPoint":return o<0&&(o=c.length+o),n.point(c[o],s,t);case"LineString":return l<0&&(l=c.length+l),n.point(c[l],s,t);case"Polygon":return a<0&&(a=c.length+a),l<0&&(l=c[a].length+l),n.point(c[a][l],s,t);case"MultiLineString":return o<0&&(o=c.length+o),l<0&&(l=c[o].length+l),n.point(c[o][l],s,t);case"MultiPolygon":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a),l<0&&(l=c[o][a].length-l),n.point(c[o][a][l],s,t)}throw new Error("geojson is invalid")}}));e(r);r.coordEach,r.coordReduce,r.propEach,r.propReduce,r.featureEach,r.featureReduce,r.coordAll,r.geomEach,r.geomReduce,r.flattenEach,r.flattenReduce,r.segmentEach,r.segmentReduce,r.lineEach,r.lineReduce,r.findSegment,r.findPoint;var i=e(t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=6378137;function i(e){var t=0;if(e&&e.length>0){t+=Math.abs(o(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(o(e[n]))}return t}function o(e){var t,r,i,o,l,s,c=0,u=e.length;if(u>2){for(s=0;s<u;s++)s===u-2?(i=u-2,o=u-1,l=0):s===u-1?(i=u-1,o=0,l=1):(i=s,o=s+1,l=s+2),t=e[i],r=e[o],c+=(a(e[l][0])-a(t[0]))*Math.sin(a(r[1]));c=c*n*n/2}return c}function a(e){return e*Math.PI/180}t.default=function(e){return r.geomReduce(e,(function(e,t){return e+function(e){var t,n=0;switch(e.type){case"Polygon":return i(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)n+=i(e.coordinates[t]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)}),0)}})));const o={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},a={POLYGON:"polygon",LINE:"line_string",POINT:"point"},l={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},s={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},c={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},u={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},d={ACTIVE:"true",INACTIVE:"false"},g=function(e){const t=e.featureTarget;return!!t&&(!!t.properties&&t.properties.meta===u.VERTEX)},f=function(e){return 27===e.keyCode},p=function(e){return 13===e.keyCode};const h=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function y(e){return{enable:function(t){setTimeout((function(){t.map&&t.map[e]&&t._ctx&&t._ctx.store&&t._ctx.store.getInitialConfigValue&&t._ctx.store.getInitialConfigValue(e)&&t.map[e].enable()}),0)},disable(t){setTimeout((function(){t.map&&t.map[e]&&t.map[e].disable()}),0)}}}const m=y("doubleClickZoom"),v=y("dragPan"),b=e=>i(e),E={onSetup:function({areaLimit:e,areaChangedCallback:t,exceedCallback:n,exceedCallsOnEachMove:r=!1,allowCreateExceeded:i=!1,escapeKeyStopsDrawing:s=!0}){const c=this.newFeature({type:l.FEATURE,properties:{},geometry:{type:l.POLYGON,coordinates:[[]]}});return this.addFeature(c),this.clearSelectedFeatures(),m.disable(this),v.disable(this),this.updateUIClasses({mouse:o.ADD}),this.activateUIButton(a.POLYGON),this.setActionableState({trash:!0}),e&&(this.areaLimit=e),this.allowCreateExceeded=i,this.exceedCallsOnEachMove=r,this.escapeStopsDrawing=s,n&&(this.exceedCallback=n),t&&(this.areaChangedCallback=t),{rectangle:c,dragMoving:!1,sizeExceeded:!1,currentArea:0}},onClick:function(e,t){if(e.startPoint)e.startPoint&&e.startPoint[0]!==t.lngLat.lng&&e.startPoint[1]!==t.lngLat.lat&&e.dragMoving&&(!e.sizeExceeded||this.allowCreateExceeded)&&(this.updateUIClasses({mouse:"pointer"}),e.endPoint=[t.lngLat.lng,t.lngLat.lat],this.changeMode(s.SIMPLE_SELECT,{featureIds:[e.rectangle.id]}));else{const n=[t.lngLat.lng,t.lngLat.lat];e.startPoint=n,this.updateUIClasses({mouse:o.ADD}),e.rectangle.updateCoordinate("0.0",t.lngLat.lng,t.lngLat.lat),e.rectangle.updateCoordinate("0.1",t.lngLat.lng,t.lngLat.lat)}}};E.onMouseUp=E.onClick,E.onMouseDown=E.onClick,E.onTouchStart=E.onClick,E.onTouchEnd=function(e,t){e.startPoint&&e.startPoint[0]!==t.lngLat.lng&&e.startPoint[1]!==t.lngLat.lat?(E.onMouseMove(e,t),this.updateUIClasses({mouse:"pointer"}),e.endPoint=[t.lngLat.lng,t.lngLat.lat],this.changeMode(s.SIMPLE_SELECT,{featureIds:[e.rectangle.id]})):E.onClick(e,t)},E.onTap=function(e,t){e.startPoint||this.onClick(e,t)},E.onMouseMove=function(e,t){if(e.dragMoving=!0,g(t)&&this.updateUIClasses({mouse:o.POINTER}),e.startPoint?(e.rectangle.updateCoordinate("0.1",t.lngLat.lng,e.startPoint[1]),e.rectangle.updateCoordinate("0.2",t.lngLat.lng,t.lngLat.lat),e.rectangle.updateCoordinate("0.3",e.startPoint[0],t.lngLat.lat),e.rectangle.updateCoordinate("0.4",e.startPoint[0],e.startPoint[1])):e.rectangle.updateCoordinate("0.0",t.lngLat.lng,t.lngLat.lat),this.areaLimit){let t=b(e.rectangle);t>0&&e.currentArea!==t&&this.areaChangedCallback&&this.areaChangedCallback(t),e.currentArea=t,t>this.areaLimit?(e.sizeExceeded&&!this.exceedCallsOnEachMove||this.exceedCallback&&this.exceedCallback(t),e.sizeExceeded=!0,e.rectangle.properties.size_exceed=!0):(e.sizeExceeded=!1,e.rectangle.properties.size_exceed=!1)}},E.onDrag=E.onMouseMove,E.onTouchMove=E.onMouseMove,E.onStop=function(e){this.updateUIClasses({mouse:o.NONE}),m.enable(this),v.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.rectangle.id)&&(e.rectangle.removeCoordinate("0.5"),e.rectangle.isValid()?this.map.fire(c.CREATE,{features:[e.rectangle.toGeoJSON()]}):(this.deleteFeature([e.rectangle.id],{silent:!0}),this.changeMode(s.SIMPLE_SELECT,{},{silent:!0})))},E.onKeyUp=function(e,t){f(t)&&(this.escapeStopsDrawing?(this.deleteFeature([e.rectangle.id],{silent:!0}),this.changeMode(s.SIMPLE_SELECT)):p(t)&&this.changeMode(s.SIMPLE_SELECT,{featureIds:[e.rectangle.id]}))},E.onTrash=function(e){this.deleteFeature([e.rectangle.id],{silent:!0}),this.changeMode(s.SIMPLE_SELECT)},E.toDisplayFeatures=function(e,t,n){const r=t.properties.id===e.rectangle.id;if(t.properties.active=r?d.ACTIVE:d.INACTIVE,!r)return n(t);if(0===t.geometry.coordinates.length)return;var i,o,a,s;if(!(t.geometry.coordinates[0].length<3)&&(n((i=e.rectangle.id,o=t.geometry.coordinates[0][0],a="0.0",s=!1,{type:l.FEATURE,properties:{meta:u.VERTEX,parent:i,coord_path:a,active:s?d.ACTIVE:d.INACTIVE},geometry:{type:l.POINT,coordinates:o}})),t.properties.meta=u.FEATURE,e.startPoint))return n(t)};const w=[{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":["case",["!",["to-boolean",["get","user_size_exceed"]]],"#fbb03b","#ff0000"],"fill-opacity":.2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["!",["to-boolean",["get","user_size_exceed"]]],"#fbb03b","#ff0000"],"line-dasharray":[.2,2],"line-width":2}}];function P(e){return h.filter(t=>!e.map(({id:e})=>e).includes(t.id)).concat(e)}const L=P(w);export default E;export{w as ActivePolygonStyles,L as DrawStyles,P as overrideDefaultStyles};
